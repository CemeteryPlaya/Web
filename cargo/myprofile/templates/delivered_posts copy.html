<!DOCTYPE html>
<html lang="ru">
{% load static %}    	

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inter Cargo - доставка из Китая в Казахстан</title>
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script>tailwind.config={theme:{extend:{colors:{primary:'#e53e3e',secondary:'#4a5568'},borderRadius:{'none':'0px','sm':'4px',DEFAULT:'8px','md':'12px','lg':'16px','xl':'20px','2xl':'24px','3xl':'32px','full':'9999px','button':'8px'}}}}</script>
    <link rel="stylesheet" href="{% static 'styles/css2.css' %}"/>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'styles/styles.css' %}"/>
    <link rel="stylesheet" href="{% static 'styles/remixicon/remixicon.css' %}"/>
    <script src="{% static 'scripts/scripts.js' %}"></script>
</head>
<body class="bg-gray-50 min-h-screen">
{% include 'includes/header.html' %}

{% block content %}

<div class="flex min-h-screen">
  <!-- Sidebar -->
  {% include 'includes/sidebar.html' %}

  <!-- Main Content -->
  <div class="container mx-auto px-4 py-6 text-gray-700 space-y-4">

    <h1 class="text-2xl font-bold mb-4">Доставленные трек-коды</h1>

    {% if grouped_trackcodes %}
      {% for date, group in grouped_trackcodes.items %}
        <div class="mb-6 p-4 border border-gray-300 rounded shadow-sm">
          <h2 class="text-lg font-semibold mb-2">{{ date }}</h2>
          <ul class="space-y-2">
            {% for track in group.tracks %}
              <li class="border p-3 rounded bg-gray-50">
                <div class="font-medium">Трек-код: {{ track.track_code }}</div>
                <div>Описание: {{ track.description|default:"—" }}</div>
                <div>Вес: {{ track.weight }} кг</div>
                <div>Стоимость: {{ track.price }} тг</div>
              </li>
            {% endfor %}
          </ul>
          <div class="mt-3 font-semibold">
            Итого: {{ group.total_weight }} кг / {{ group.total_price }} тг
          </div>
        </div>
      {% endfor %}
    {% else %}
      <p>Нет доставленных трек-кодов.</p>
    {% endif %}

    <hr class="my-6">

    <h2 class="text-xl font-bold mb-4">Сформированные чеки</h2>

    {% if receipts %}
      {% for receipt in receipts %}
        <div class="mb-4 border border-gray-300 rounded p-4 shadow bg-white">
          <h3 class="font-semibold text-lg mb-2">Чек #{{ receipt.id }} — {{ receipt.created_at|date:"d.m.Y" }}</h3>
          <p>Общий вес: {{ receipt.total_weight }} кг</p>
          <p>Итого: {{ receipt.total_price }} тг</p>
          <p>
            Статус оплаты:
            <span class="font-semibold {% if receipt.is_paid %}text-green-600{% else %}text-red-600{% endif %}">
              {{ receipt.is_paid|yesno:"Оплачен,Не оплачен" }}
            </span>
          </p>
          <ul class="mt-2 list-disc list-inside text-sm text-gray-700">
            {% for item in receipt.items.all %}
              <li>{{ item.track_code.track_code }} — {{ item.track_code.weight }} кг</li>
            {% endfor %}
          </ul>
        </div>
      {% endfor %}
    {% else %}
      <p>Чеки ещё не сформированы.</p>
    {% endif %}

  </div>
</div>
  {% endblock %}

{% include 'includes/footer.html' %}
</body>
</html>